(()=>{var i="";try{let e=window.location.hostname;i=window.location.origin}catch{i=""}async function m(e){let t=await fetch(`${i}/strong/search?q=${encodeURIComponent(e)}`,{headers:{Accept:"application/json"}});if(!t.ok){let n=await t.text().catch(()=>""),r=Array.from(t.headers.entries()).slice(0,6).map(o=>o.join(": ")).join("; ");throw new Error(`Search failed: status=${t.status} ${t.statusText}; headers=${r}; bodyPreview=${n.slice(0,300)}`)}if((t.headers.get("content-type")||"").includes("text/html")){let n=await t.text().catch(()=>"<html response>"),r=Array.from(t.headers.entries()).slice(0,6).map(o=>o.join(": ")).join("; ");throw new Error(`Search returned HTML (probably wrong route): status=${t.status} ${t.statusText}; headers=${r}; bodyPreview=${n.slice(0,400)}`)}return t.json()}var d=document.getElementById("q"),g=document.getElementById("go"),s=document.getElementById("results"),a=document.getElementById("loading-status");(async()=>{try{await(void 0)(t=>{a&&(a.textContent=t)}),a&&(a.style.display="none");let e=new URLSearchParams(location.search);e.get("q")&&(d.value=e.get("q"),f())}catch(e){a&&(a.textContent="DB init failed: "+String(e))}})();async function f(){let e=(d.value||"").trim();if(!e){s.innerHTML="<div>Enter a query</div>";return}s.innerHTML="<div>Searching\u2026</div>";try{let t=await m(e);if(!t||!t.length){s.innerHTML="<div>(no results)</div>";return}let u=document.createElement("ul");t.forEach(n=>{let r=document.createElement("li"),o=document.createElement("div");o.style.fontWeight="600",o.textContent=n.strong,r.appendChild(o);let p=document.createElement("div");p.innerHTML=`<strong>Translations:</strong> ${Array.isArray(n.translation)?n.translation.slice(0,6).map(h=>y(h)).join(", "):""}`,r.appendChild(p);let w=document.createElement("div");w.innerHTML=`<strong>Originals:</strong> ${Array.isArray(n.original)?n.original.slice(0,6).map(h=>y(h)).join(", "):""}`,r.appendChild(w);let c=document.createElement("a");c.href="strong.html#"+encodeURIComponent(n.strong),c.textContent="Open details",c.style.marginTop="6px",c.target="_blank",r.appendChild(c),u.appendChild(r)}),s.innerHTML="",s.appendChild(u)}catch(t){s.innerHTML="<div>Error: "+String(t)+"</div>"}}function y(e){return e==null?"":String(e).replace(/[&<>"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"})[t])}d.addEventListener("keydown",e=>{e.key==="Enter"&&f()});g.addEventListener("click",f);})();
